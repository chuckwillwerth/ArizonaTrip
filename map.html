<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Arizona Trip Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="map.css">
</head>

<body>
  <header>
    <h1>ğŸŒµ Arizona Trip</h1>
    <span class="subtitle">February 14â€“20 â€¢ Phoenix â†’ Sedona â†’ Grand Canyon</span>
    <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap">
      <div class="theme-switcher" style="margin:0">
        <button class="theme-btn" data-theme="light" title="Light map">â˜€ï¸ Light</button>
        <button class="theme-btn active" data-theme="terrain" title="Terrain map">ğŸ”ï¸ Terrain</button>
        <button class="theme-btn" data-theme="dark" title="Dark map">ğŸŒ™ Dark</button>
      </div>
      <div class="theme-switcher" style="margin:0">
        <button class="view-btn active" data-view="all" title="All locations">ğŸ“ All Locations</button>
        <button class="view-btn" data-view="evelyn" title="Evelyn's full plan">ğŸŸ¢ Evelyn's Plan</button>
        <button class="view-btn" data-view="planner" title="Plan your days">ğŸ—“ï¸ Day Planner</button>
      </div>
      <div class="plan-selector" style="margin:0">
        <select id="plan-select" class="plan-select" title="Select a plan">
          <option value="default">Default Plan</option>
        </select>
        <button class="plan-manage-btn" id="plan-manage-btn" title="Manage plans">âš™ï¸</button>
      </div>
      <div class="theme-switcher" style="margin:0">
        <button class="routing-btn" data-routing="osrm" title="OSRM routing (free, open-source)">ğŸ—ºï¸ OSRM</button>
        <button class="routing-btn" data-routing="google" title="Google Maps routing">ğŸŒ Google</button>
      </div>
    </div>
    <button class="add-loc-btn" id="add-loc-btn" title="Add a custom location">â• Add Location</button>
  </header>

  <div class="container">
    <div id="map"></div>
    <button class="locate-btn" id="locate-btn" title="Find my location">ğŸ“</button>
    <div id="sidebar">
      <button class="sidebar-toggle" id="sidebar-toggle" title="Toggle sidebar">â–²</button>
      <div class="sidebar-drag-handle"></div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <div class="legend">
    <h4>Legend</h4>
    <div class="legend-item">ğŸ  Hotels / Lodging</div>
    <div class="legend-item">âœˆï¸ Flights</div>
    <div class="legend-item">ğŸŒ² Parks / Nature</div>
    <div class="legend-item">ğŸ¡ Attractions / Towns</div>
    <div class="legend-item">â­ Suggested (Family-Friendly)</div>
    <div class="legend-item">ğŸŸ¢ Evelyn's Picks</div>
    <div class="legend-item">ğŸ½ï¸ Food & Dining</div>
    <div class="legend-item">ğŸ“Œ Custom Locations</div>
    <div class="legend-item">
      <div class="legend-dot" style="background:rgba(99,102,241,0.4); border: 2px dashed #6366f1"></div> Route
    </div>
    <div class="legend-item" style="margin-top:6px;font-size:0.7rem;color:var(--text-muted)">Click two markers for
      driving route</div>
  </div>

  <div class="route-hint" id="routeHint"></div>

  <div class="route-panel" id="routePanel">
    <div class="route-panel-header">
      <h3>ğŸš§ Driving Route</h3>
      <button class="route-panel-close" id="routeClose" title="Clear route">âœ•</button>
    </div>
    <div class="route-endpoints" id="routeEndpoints"></div>
    <div class="route-stats" id="routeStats"></div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    // Load Google Maps API asynchronously when needed
    window.loadGoogleMapsAPI = function(apiKey) {
      return new Promise((resolve, reject) => {
        if (window.google && window.google.maps) {
          resolve();
          return;
        }
        
        if (!apiKey || apiKey.trim() === '') {
          reject(new Error('Google Maps API key not configured. Please set it in map.js (routingConfig.googleMapsApiKey) or via localStorage.setItem("googleMapsApiKey", "YOUR_KEY")'));
          return;
        }
        
        window.initGoogleMaps = function() {
          delete window.initGoogleMaps;
          resolve();
        };
        
        const script = document.createElement('script');
        script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&callback=initGoogleMaps`;
        script.onerror = () => reject(new Error('Failed to load Google Maps API'));
        document.head.appendChild(script);
      });
    };
  </script>
  <script src="map.js"></script>
</body>

</html>